## 什麼是 DNS？Google 有提供的公開的 DNS，對 Google 的好處以及對一般大眾的好處是什麼？

DNS 是可以解析網域名稱的系統。上網其實就是從自己的電腦連線到對方的電腦，在網路通訊協定中，IP 可以代表美台連網主機的位址，通訊上只會認 IP，而 IP 以數字組成，以最常用的 IPv4 來講，就是由四組數字以「.」分隔組成，例如 140.118.XXX.XXX 這樣的組成。在上網的時候，其實就是下指令讓電腦連線到特定 IP 位址的主機，但是這樣很會讓人類很難記憶，因為這樣的四組數字完全沒有語意，會讓人很難記得。於是域名 (domain) 與 DNS 就被發明了。  
使用域名、DNS 還有 IP 進行網路連線，很像是打電話用電話簿。電話號碼一樣是沒有語意的數字，而公司行號、個人都有自己的電話號碼，在每個人都用打電話與彼此聯絡的時候，當聯絡人越多，就越有可能發生忘記某個人電話的狀況。這個時候就有人發現，那我就用一張表記錄每個人還有每個電話號碼的對應關係，這就是我自己的通訊錄。這樣如果我想要打電話給 Morrison，我只要查一下通訊錄，就可以知道他的號碼。那假設通訊錄沒有 Morrison 的電話號碼要怎麼辦？那我就打電話給我認識的人，問他：「你有 Morrison 的電話嗎？」他如果沒有，我就再問下一個，當我問到了，我就把 Morrison 的電話加到自己的通訊錄裡面，然後打電話給他叫他起床尿尿。  
IP、DNS 還有域名的關係也是這樣，只是把上面的流程更加標準化、規模化。當電腦收到要連線到某個域名的指令，如果電腦的 DNS catche 沒有儲存這個域名對應的 IP，那電腦就會對已經設定好的 DNS server 發出查詢 request 並且帶著域名，這個 DNS server 如果也沒有這個域名的 IP，那它就會對 server 設定好的上層 DNS server 發出查詢 request，當查到結果之後，就會順著這條查詢的路徑一路回傳，當每經過一個主機，就會把這個結果寄到自己的 DNS catche，然後繼續回傳，最後傳回自己的主機，把結果寫入 DNS catche 後，發出連線的 request 到查到的 IP。  
仔細想想，DNS server 既然是一台 server 代表它也是一台電腦，而 server 幾乎要 24/7 開機服務，不論硬體、電費、場地都要錢，可是大家在用網路的時候好像都沒有被收到 DNS server 的費用。如果是用電信業者的網路服務，DNS server 可以當作贈品或者是已經附在服務之內；而公家機關與學校的網路也有自有的 DNS server 可以用。這樣看起來，會用網路的族群其實都已經有 DNS 服務的提供者，那為何 google 既不提供網路服務，也不是公家機關也要提供免費的 DNS 給所有人使用，而竟然也有人會用？先從為何有人會用，這是因為 google 提供的 DNS 真的比業者以及學校提供的 DNS 更穩定也更快速，可以享受更好的網路連線體驗，也有人表示使用 google 的 DNS 連外國網路也比較快，既然不用多花錢又可以又更好的網路，大家當然會用。而 google 又為何提供呢？這樣從 google 的商業模式來說，google 提供免費的瀏覽器、搜尋引擎以及 DNS 服務，身為全球大企業不可能沒有商業考量，google 營收有很大一部份是廣告營收，而現在賣廣告除了單純賣版位之外，也會提供廣告主很多付費資訊，讓廣告主可以更精準的投放廣告。那 google 怎麼取得這些資訊？其實就是透過他們提供的免費服務來取得。以 DNS 為例，當一個使用者使用 google DNS 查詢某個域名， google 就會有記錄這個查詢來自哪個 IP，而 google 的資料庫中也有關於這個網站的網頁資訊，當他們搜集資訊之後，就可以分析某個 IP 位址的使用者可能會喜歡哪種商品，google 就可以把這個資訊賣給廣告主，廣告主就可以針對這個 IP 位址精準投放廣告。

## 什麼是資料庫的 lock？為什麼我們需要 lock？

一個擁有很多使用者的網路服務，例如網銀、論壇，其資料庫隨時都有很多使用者存取與修改，但是這樣同時讀取與修改的情況，可能會造成資料有誤。例如銀行帳戶餘額，假設今天 Leo 的帳戶只有五千元，而現在有兩個要從 Leo 帳戶扣款五千元的請求同時進來，這樣就可能會有，兩個請求都會先看 Leo 的帳戶餘額，並確定足夠扣款，就執行了扣款，並且各自在另一個帳戶加進五千元，而 Leo 的帳戶餘額變成零元。在這個過程結束後，整個資料庫中突然多出了五千元，Leo 僅僅用五千元達成了一萬元的扣款。這種狀況對整個網路服務的運作是非常嚴重的事情，因為這會讓服務的品質與體驗變得很差，而這種服務推出的目的本來是要藉著自動化達到節省成本的目的，但是若系統常出錯，就要多很多維護以及修復的成本。  
而會造成這種狀況是因為沒有對請求排程，讓請求同時進行，造成錯誤的請求。而 Lock 就是可以達到排程的工具。資料庫的 Lock 分做共享鎖(shared lock)與互斥鎖(exclusive lock)，前者是使用在讀取每筆資料有很多個，而後者使用在修改與寫入每筆資料僅有一個。Lock 的運作大概是，系統在請求近來的時候會先檢視這個請求會執行什麼動作，如果只有讀取，系統就會只給予共享鎖；而如果要對某筆資料進行寫入或修改，系統就會給予這筆資料的互斥鎖。一個請求如果沒有所有對應的 Lock 就不會動作，要等到獲得所有 Lock 之後才會執行。回到 Leo 的狀況，當兩個請求 A、B 同時進來，系統就會先檢視其中一個，假設是 A，並且給予 Leo 帳戶餘額的共享鎖與互斥鎖，再檢視 B 並給予共享鎖，而因為互斥鎖已經給 A 了，在 A 執行完之前 B 不會獲得這個互斥鎖，所以 B 會暫時不會執行，要等到 A 執行完，把互斥所釋放後，系統在把互斥鎖給 B，B 才能執行它的動作。這樣程序會變成 A 先檢視帳戶餘額，發現有五千元可以扣款，執行扣款讓餘額變成零元。接下來換 B 執行，發現餘額只有零元，餘額不足所以不進行扣款。


## NoSQL 跟 SQL 的差別在哪裡？

在 NoSQL 與 SQL 的脈絡下，SQL 指的是傳統的關聯式資料庫，在結構上是以很多不同的 Tables 來儲存資料，並且用不同種類的 index 去對應不同 table 的資料，例如圖書館資料庫可能就有一個書籍的 table 與一個作者的 table，在書籍裡面的作者欄，可能只會記錄作者的 index，而在作者 table 裡的 index 就會對應到那個作者。這種資料庫結構較為嚴謹，每筆資料之間的關係很明確，但是有其缺點，就是當資料庫規模擴大時，查詢較沒有效率，並且如果要更改資料庫結構非常麻煩。而現今的社群網站的資料庫十分龐大，也要求彈性，這兩個特性會讓傳統的 SQL 成為系統中較困難與較不相容的一部分。於是像 google 與 facebook 就採用有別於傳統 SQL 的 NoSQL 資料庫，NoSQL 是非關聯式資料庫的統稱，與 SQL 最大不同的一點是其資料結構不是傳統關聯式資料庫的 table、row、colunm，而是採用 key - value 的對應方式儲存。這種資料儲存方式可以達到分散式儲存以及容易擴充的特性，雖然無法達到傳統 SQL ACID 的所有特性，不過因為使用者其實較不在意這點，所以是可以容忍的。而且 NoSQL 較 SQL 執行上更快更有效率，更適合社群網站的有大量資料吞吐的特性。


## 資料庫的 ACID 是什麼？

資料庫的 ACID 主要指傳統的 SQL 資料庫的四個特性
A(tomicity)：有一個最小的運作單位，這個最小單位在傳統的資料庫理論上稱作 transaction。這個最小單位是運作的最小單位，只會有成功與失敗兩種結果，中間不會有斷點，若是在執行中遇到錯誤，就會停止執行並且不會更動任何資料。
C(onsistency)：只在運作之後，整個資料庫的資料會與運作單位相符。在 transaction 結束後，如果失敗，資料就會跟執行前一樣；如果成功，就會和 transaction 執行預期的結果一致，不會有第三種狀況。
I(solation)：多人同時操作資料庫之下，所有使用者的操作互不干擾。
D(urability)：transaction 執行後的資料可以永久保存，即使資料庫系統損壞，資料也可以保存。